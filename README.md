# README: Докеризация приложения

## Цель лабораторной работы
Цель данной лабораторной работы - собрать из исходного кода и запустить в Docker рабочее приложение с базой данных, используя легковесные образы и следуя лучшим практикам.

## Описание проекта
В этом проекте мы используем Docker для контейнеризации приложения, написанного на JavaScript с использованием Node.js и PostgreSQL.

## Требования
1. Образ должен быть легковесным.
2. Использовать базовые легковесные образы - Alpine.
3. Вся конфигурация приложения должна быть через переменные окружения.
4. Статика (зависимости) должна быть внешним томом `volume`.
5. Создать файл `docker-compose.yml` для старта и сборки.
6. В `docker-compose.yml` нужно использовать базу данных (PostgreSQL).
7. При старте приложения должно быть учтено выполнение автоматических миграций.
8. Контейнер должен запускаться от непривилегированного пользователя.
9. После установки всех нужных утилит, должен очищаться кеш.

## Структура проекта
```
project/
│
├── app/
│ ├── config/
│ │ ├── config.json
│ │ ├── passport.js
│ │ └── database.js
│ └── app.js
│
├── Dockerfile
└── docker-compose.yml
```
## Инструкция по запуску

### 1. Создание Dockerfile
Создайте файл `Dockerfile` в корне проекта. Пример содержимого:

```dockerfile
# Используем легковесный образ Alpine
FROM node:18-alpine

# Устанавливаем рабочую директорию
WORKDIR /app

# Копируем package.json и устанавливаем зависимости
COPY app/package*.json ./
RUN npm install && npm cache clean --force

# Копируем остальной код приложения
COPY app/ .

# Устанавливаем переменные окружения
ENV NODE_ENV=production

# Запускаем миграции и приложение
CMD ["npx", "sequelize-cli", "db:migrate"]
ENTRYPOINT ["node", "app.js"]
```

### 2. Создание docker-compose.yml
Создайте файл `docker-compose.yml` в корне проекта. Пример содержимого:

```yaml
services:
  libra:
    image: libra:2
    build: .
    ports:
      - "3000:3000"
    environment:
      - "DB_NAME=postgres"
      - "DB_USER=postgres"
      - "DB_PASSWORD=postgres"
    depends_on:
      - database

  database:
    image: postgres:17.2-alpine
    volumes:
      - ./db:/var/lib/postgresql/data
    environment:
      - "POSTGRES_DB=postgres"
      - "POSTGRES_USER=postgres"
      - "POSTGRES_PASSWORD=postgres"
    ports:
      - "5432:5432"
```

### 3. Запуск приложения
Для запуска приложения выполните команду:

```bash
docker-compose up --build
```

# Libra Project

## Описание

Libra - это проект, который предоставляет доступ к электронно библиотеке. Он разработан с использованием Node.js, Express, PostgreSQL, Passport.js, и включает в себя возможность развертывания с помощью Docker.

## Докеризация

Докеризация проекта Libra позволяет легко развертывать и управлять приложением в контейнерах. Это обеспечивает изоляцию среды выполнения и упрощает процесс развертывания на различных платформах.

### Шаги для запуска проекта с помощью Docker

1. **Клонируйте репозиторий:**
   ```bash
   git clone <URL вашего репозитория>
   cd Libra
   ```

2. **Соберите образ Docker:**
   В корневом каталоге проекта выполните следующую команду:
   ```bash
   docker-compose build
   ```

3. **Запустите контейнеры:**
   После сборки образа запустите контейнеры с помощью:
   ```bash
   docker-compose up
   ```

4. **Доступ к приложению:**
   После успешного запуска контейнеров, ваше приложение будет доступно по адресу `http://localhost:3000` (или другому порту, указанному в `docker-compose.yml`).

### Структура файлов

- **Dockerfile**: Определяет, как будет собираться образ вашего приложения.
- **docker-compose.yml**: Содержит конфигурацию для запуска нескольких контейнеров, включая базу данных и ваше приложение.
- **app/config/**: Содержит конфигурационные файлы приложения, такие как настройки базы данных и аутентификации.

### Примечания

- Убедитесь, что у вас установлен Docker и Docker Compose на вашей машине.
- Для изменения конфигурации, например, базы данных, отредактируйте соответствующие файлы в каталоге `app/config/`.
